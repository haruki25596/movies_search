<div class='container'>
  <div class='row'>
    <div class='col-md-2'></div>
        <div class='col-md-5 offset-md-1'>
            <div class="sidebar">
        <section class="categories">
          <h2 class="categories-heading common-heading">Categories</h2>
          <div class="sidebar-contents">
            <p class="categories-text">Technology(15)</p>
            <p class="categories-text">Business(23)</p>
            <p class="categories-text">Entertainment(12)</p>
            <p class="categories-text">Nature(32)</p>
            <p class="categories-text">Education(9)</p>
            <p class="categories-text">Adventure(23)</p>
            <p class="categories-text">Communication(14)</p>
          </div>
        </section>
      </div>
            <h2>映画検索</h2>
              <%= form_with url: search_movies_path, method: :get, local: true do |form| %>
                <%= form.text_field :keyword %>
                <%= form.submit '検索'%>
              <% end %>

            <%# 検索された時にコンテンツを表示する %>
            <%if params[:keyword].present? %>
                <% movieinfo = JSON.parse((Tmdb::Search.movie(params[:keyword])).to_json) %>
                <h2><%= params[:keyword] %>の検索結果</h2>
                <% i = 0 %>
                <div class="card-wrapper">
                    <% while i < movieinfo['table']['results'].count %>
                        <div class="card">
                            <% if movieinfo['table']['results'][i]['table']['poster_path'].present? %>
                                <div><%= image_tag 'https://image.tmdb.org/t/p/w1280' + movieinfo['table']['results'][i]['table']['poster_path'],class: "card-img" %></div>
                            <%end%>

                            <div class="card-upperinfo">
                                <%if movieinfo['table']['results'][i]['table']['title'].present?%>
                                    <h3><%= link_to movieinfo['table']['results'][i]['table']['title'],movie_path(movieinfo['table']['results'][i]['table']['id']) %></h3>
                                <%end%>

                                <% if movieinfo['table']['results'][i]['table']['release_date'].present? %>
                                    <div class="release-date"><%= movieinfo['table']['results'][i]['table']['release_date'] %></div>
                                <%end%>
                            </div>
                        </div>
                        <% i += 1%>
                    <%end%>
                </div>
            <%else%>
                <%# 検索されていない時にトレンドコンテンツを表示する %>
                <h2>本日の世界のトレンド</h2>
                <% movieinfo = JSON.parse((Tmdb::Movie.popular).to_json) %>
                <% i = 0 %>
                <div class="card-wrapper">
                    <% while i < movieinfo['table']['results'].count %>
                        <div class="card">
                            <% if movieinfo['table']['results'][i]['table']['poster_path'].present? %>
                                <div><%= image_tag 'https://image.tmdb.org/t/p/w1280' + movieinfo['table']['results'][i]['table']['poster_path'],class: "card-img" %></div>
                            <%end%>
                            <div class="card-upperinfo">
                                <%if movieinfo['table']['results'][i]['table']['title'].present?%>
                                    <h3><%= link_to movieinfo['table']['results'][i]['table']['title'], movie_path(movieinfo['table']['results'][i]['table']['id'])%></h3>
                                <%end%>

                                <% if movieinfo['table']['results'][i]['table']['release_date'].present? %>
                                    <div class="release-date"><%= movieinfo['table']['results'][i]['table']['release_date'] %></div>
                                <%end%>
                            </div>
                        </div>
                    <% i += 1%>
                    <%end%>
                </div>
            <%end%>
         </div>
      <div class='col-md-5'></div>
   </div>
</div>
